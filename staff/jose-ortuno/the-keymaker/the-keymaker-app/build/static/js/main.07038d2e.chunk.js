(window["webpackJsonpthe-keymaker-app"]=window["webpackJsonpthe-keymaker-app"]||[]).push([[0],{135:function(e,t,a){e.exports=a(282)},141:function(e,t,a){},165:function(e,t){},167:function(e,t){},215:function(e,t){},216:function(e,t){},275:function(e,t,a){},280:function(e,t,a){},281:function(e,t,a){},282:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(132),s=a.n(c),l=a(1),o=a.n(l),i=a(2),u=a(4),m=(a(141),a(6));var d="AIzaSyDdx1PrjoxeKY7po8NgDapK9Vd4J8GLFlI";var p={set __token__(e){sessionStorage.token=e},get __token__(){return sessionStorage.token},registerUser:function(e,t,a,n){return Object(i.a)(o.a.mark((function r(){var c,s,l;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fetch("".concat("http://localhost:8080/api","/users"),{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({alias:e,email:t,password:a,repassword:n})});case 2:if(201===(c=r.sent).status){r.next=9;break}return r.next=6,c.json();case 6:throw s=r.sent,l=s.error,Error(l);case 9:case"end":return r.stop()}}),r)})))()},authenticateUser:function(e,t){var a=this;return m.validate.string(e,"e-mail"),m.validate.email(e,"e-mail"),m.validate.string(t,"password"),Object(i.a)(o.a.mark((function n(){var r,c,s,l,i;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat("http://localhost:8080/api","/auth"),{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({email:e,password:t})});case 2:if(200!==(r=n.sent).status){n.next=10;break}return n.next=6,r.json();case 6:return c=n.sent,s=c.token,a.__token__=s,n.abrupt("return");case 10:return n.next=12,r.json();case 12:throw l=n.sent,i=l.error,Error(i);case 15:case"end":return n.stop()}}),n)})))()},isUserLogged:function(){return sessionStorage.token},logUserOut:function(){sessionStorage.clear()},retrieveUser:function(){var e=this;return Object(i.a)(o.a.mark((function t(){var a,n,r,c,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat("http://localhost:8080/api","/users/"),{method:"get",headers:{authorization:"bearer ".concat(e.__token__)}});case 2:if(200===(a=t.sent).status){t.next=9;break}return t.next=6,a.json();case 6:throw n=t.sent,r=n.error,Error(r);case 9:return t.next=11,a.json();case 11:return c=t.sent,s=c.user,t.abrupt("return",s);case 14:case"end":return t.stop()}}),t)})))()},retrieveDeployments:function(){var e=this;return Object(i.a)(o.a.mark((function t(){var a,n,r,c,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat("http://localhost:8080/api","/deployments"),{method:"get",headers:{authorization:"bearer ".concat(e.__token__)}});case 2:if(200===(a=t.sent).status){t.next=9;break}return t.next=6,a.json();case 6:throw n=t.sent,r=n.error,Error(r);case 9:return t.next=11,a.json();case 11:return c=t.sent,s=c.deployments,t.abrupt("return",s);case 14:case"end":return t.stop()}}),t)})))()},retrieveDeployment:function(e){var t=this;return Object(i.a)(o.a.mark((function a(){var n,r,c,s,l;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch("".concat("http://localhost:8080/api","/deployment/").concat(e),{method:"get",headers:{authorization:"bearer ".concat(t.__token__)}});case 2:if(200===(n=a.sent).status){a.next=9;break}return a.next=6,n.json();case 6:throw r=a.sent,c=r.error,Error(c);case 9:return a.next=11,n.json();case 11:return s=a.sent,l=s.deployment,a.abrupt("return",l);case 14:case"end":return a.stop()}}),a)})))()},registerDeployment:function(e,t,a,n,r){var c=this;return a=function(e,t){if("number"===e)return Number(t);if("boolean"===e){if("true"===t)return!0;if("false"===t)return!1}}("boolean",a),Object(i.a)(o.a.mark((function s(){var l,i,u,m;return o.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,fetch("".concat("http://localhost:8080/api","/deployment"),{method:"post",headers:{"content-type":"application/json",authorization:"bearer ".concat(c.__token__)},body:JSON.stringify({alias:e,address:t,status:a,longitude:n,latitude:r})});case 2:if(201===(l=s.sent).status){s.next=9;break}return s.next=6,l.json();case 6:throw i=s.sent,u=i.error,Error(u);case 9:return s.next=11,l.json();case 11:return m=s.sent,s.abrupt("return",m);case 13:case"end":return s.stop()}}),s)})))()},registerDeploymentImage:function(e,t){var a=this,n=new FormData;return n.append("image",t),Object(i.a)(o.a.mark((function t(){var r,c,s,l,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat("http://localhost:8080/api","/users/deployment/").concat(e,"/upload"),{method:"post",headers:{authorization:"bearer ".concat(a.__token__)},body:n});case 2:if(200===(r=t.sent).status){t.next=9;break}return t.next=6,r.json();case 6:throw c=t.sent,s=c.error,new Error(s);case 9:return t.next=11,r.json();case 11:return l=t.sent,i=l.message,t.abrupt("return",i);case 14:case"end":return t.stop()}}),t)})))()},registerKey:function(e,t,a,n,r){var c=this;return m.validate.string(a,"alias guest"),m.validate.string(n,"email guest"),m.validate.string(r,"deployment id"),Object(i.a)(o.a.mark((function s(){var l,i,u,m;return o.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,fetch("".concat("http://localhost:8080/api","/key"),{method:"post",headers:{"content-type":"application/json",authorization:"bearer ".concat(c.__token__)},body:JSON.stringify({validFrom:e,validUntil:t,aliasGuest:a,emailGuest:n,deploymentId:r})});case 2:if(201===(l=s.sent).status){s.next=9;break}return s.next=6,l.json();case 6:throw i=s.sent,u=i.error,Error(u);case 9:return s.next=11,l.json();case 11:return m=s.sent,s.abrupt("return",m);case 13:case"end":return s.stop()}}),s)})))()},retrieveKeys:function(){var e=this;return Object(i.a)(o.a.mark((function t(){var a,n,r,c,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat("http://localhost:8080/api","/keys"),{method:"get",headers:{authorization:"bearer ".concat(e.__token__)}});case 2:if(200===(a=t.sent).status){t.next=9;break}return t.next=6,a.json();case 6:throw n=t.sent,r=n.error,Error(r);case 9:return t.next=11,a.json();case 11:return c=t.sent,s=c.keys,t.abrupt("return",s);case 14:case"end":return t.stop()}}),t)})))()},retrieveKey:function(e){return Object(i.a)(o.a.mark((function t(){var a,n,r,c,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat("http://localhost:8080/api","/key/").concat(e),{method:"get"});case 2:if(200===(a=t.sent).status){t.next=9;break}return t.next=6,a.json();case 6:throw n=t.sent,r=n.error,Error(r);case 9:return t.next=11,a.json();case 11:return c=t.sent,s=c.key,t.abrupt("return",s);case 14:case"end":return t.stop()}}),t)})))()},useKey:function(e,t,a){return Object(i.a)(o.a.mark((function n(){var r,c,s;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat("http://localhost:8080/api","/key/").concat(e,"/longitude/").concat(t,"/latitude/").concat(a),{method:"get"});case 2:if(200===(r=n.sent).status){n.next=9;break}return n.next=6,r.json();case 6:throw c=n.sent,s=c.error,Error(s);case 9:return n.next=11,r.json();case 11:return n.abrupt("return",n.sent);case 12:case"end":return n.stop()}}),n)})))()},searchKeys:function(e){var t=this;return Object(i.a)(o.a.mark((function a(){var n,r,c,s,l;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch("".concat("http://localhost:8080/api","/keys/search/").concat(e),{method:"get",headers:{authorization:"bearer ".concat(t.__token__)}});case 2:if(200===(n=a.sent).status){a.next=9;break}return a.next=6,n.json();case 6:throw r=a.sent,c=r.error,Error(c);case 9:return a.next=11,n.json();case 11:return s=a.sent,l=s.key,a.abrupt("return",l);case 14:case"end":return a.stop()}}),a)})))()},searchDeployments:function(e){var t=this;return Object(i.a)(o.a.mark((function a(){var n,r,c,s,l;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch("".concat("http://localhost:8080/api","/deployments/search/").concat(e),{method:"get",headers:{authorization:"bearer ".concat(t.__token__)}});case 2:if(200===(n=a.sent).status){a.next=9;break}return a.next=6,n.json();case 6:throw r=a.sent,c=r.error,Error(c);case 9:return a.next=11,n.json();case 11:return s=a.sent,l=s.deployment,a.abrupt("return",l);case 14:case"end":return a.stop()}}),a)})))()},getLocation:function(e){return Object(i.a)(o.a.mark((function t(){var a,n,r,c,s,l;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://maps.googleapis.com/maps/api/geocode/json?address=".concat(e,"&key=").concat(d),{method:"get"});case 2:if(200===(a=t.sent).status){t.next=9;break}return t.next=6,a.json();case 6:throw n=t.sent,r=n.error,Error(r);case 9:return t.next=11,a.json();case 11:return c=t.sent,s=c.results[0].formatted_address,l=c.results[0].geometry.location,t.abrupt("return",{getAddress:s,coordinates:l});case 15:case"end":return t.stop()}}),t)})))()}},f=a(32),v=function(e){var t=e.onBack,a=e.onRegister;return r.a.createElement("div",{className:"landing__list"},r.a.createElement("h2",null,"Register"),r.a.createElement("form",{className:"landing__form",onSubmit:function(e){e.preventDefault();var t=e.target,n=t.alias.value,r=t.email.value,c=t.password.value,s=t.repassword.value;a(n,r,c,s)}},r.a.createElement("input",{type:"text",name:"alias",placeholder:"name"}),r.a.createElement("input",{type:"email",name:"email",placeholder:"email"}),r.a.createElement("input",{type:"password",name:"password",placeholder:"password"}),r.a.createElement("input",{type:"password",name:"repassword",placeholder:"repeat password"}),r.a.createElement("button",null,r.a.createElement("i",{class:"fas fa-chevron-right"})," register")),r.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),t()}},"Go back"))},h=function(e){var t=e.onBack,a=e.onLogin;return r.a.createElement("div",{className:"landing__list"},r.a.createElement("h2",null,"Login"),r.a.createElement("form",{className:"landing__form",onSubmit:function(e){e.preventDefault();var t=e.target,n=t.email.value,r=t.password.value;a(n,r)}},r.a.createElement("input",{type:"email",name:"email",placeholder:"email"}),r.a.createElement("input",{type:"password",name:"password",placeholder:"password"}),r.a.createElement("button",null,r.a.createElement("i",{class:"fas fa-chevron-right"})," login")),r.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),t()}},"Go back"))},E=(a(275),a(11)),g=function(e){var t=e.onSearch;return r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a=e.target.query.value;t(a)}},r.a.createElement("input",{type:"text",name:"query",placeholder:"search"}),r.a.createElement("button",null,r.a.createElement("i",{class:"fas fa-search"})))},y=a(8),b=a.n(y),_=function(e){var t,a=e.onDeployment;return a&&(t=b()(a.created_at).format("HH:mm DD-MM-YYYY")),r.a.createElement("ul",null,r.a.createElement("li",{key:"".concat(m.random.number(0,99),"-").concat(a.id)},a.alias),r.a.createElement("li",{key:"".concat(m.random.number(0,99),"-").concat(a.id)},r.a.createElement("img",{src:a.logo})),r.a.createElement("li",{key:"".concat(m.random.number(0,99),"-").concat(a.id)},"created at: ",t))},k=Object(f.e)((function(e){var t=e.history,a=Object(n.useState)(void 0),c=Object(u.a)(a,2),s=c[0],l=c[1],m=Object(n.useState)(void 0),d=Object(u.a)(m,2),f=d[0],v=d[1],h=Object(n.useState)("deployments"),y=Object(u.a)(h,2),b=y[0],k=y[1];Object(n.useEffect)((function(){Object(i.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.retrieveDeployments();case 2:0===(t=e.sent).length||l(t),a=t.sort((function(e,t){return t.created_at-e.created_at})),l(a);case 6:case"end":return e.stop()}}),e)})))()}),[]);var w=function(){var e=Object(i.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.searchDeployments(t);case 3:a=e.sent,v(a),k("results"),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),"no results"===(n=e.t0.message)&&k("results"),console.error(n);case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("section",{className:"deployments view"},r.a.createElement("div",{className:"view__navigate navigate__search"},r.a.createElement("div",{className:"navigate__item"},r.a.createElement("p",null,"deployments: "),r.a.createElement("button",{onClick:function(){t.push("/deployments/register")}},r.a.createElement("i",{class:"fas fa-plus"})," deployment")),r.a.createElement("div",{className:"navigate__item"},r.a.createElement("p",null,"search deployment: "),r.a.createElement(g,{onSearch:w}),"results"===b&&r.a.createElement("button",{onClick:function(){k("deployments"),v(void 0)}},r.a.createElement("i",{class:"fas fa-plus"})," all"))),"results"===b&&r.a.createElement("h2",null,"results:"),r.a.createElement("div",{className:"view__elements"},"deployments"===b&&r.a.createElement(r.a.Fragment,null,s&&s.map((function(e){return r.a.createElement(E.b,{className:"view__element",key:e.id,to:"/deployments/detail/".concat(e.id)},r.a.createElement(_,{onDeployment:e}))}))||r.a.createElement("p",null,r.a.createElement("i",{class:"fas fa-comment-dots"})," there are no registered deployments")),"results"===b&&r.a.createElement(r.a.Fragment,null,f&&f.map((function(e){return r.a.createElement(E.b,{className:"view__element",key:e.id,to:"/deployments/detail/".concat(e.id)},r.a.createElement(_,{onDeployment:e}))}))||r.a.createElement("p",null,r.a.createElement("i",{class:"fas fa-comment-dots"})," there are no results to search"))))})),w=function(e){var t,a=e.onDeployment;a&&(t=b()(a.created_at).format("HH:mm DD-MM-YYYY"));var n=a.location,c=n.longitude,s=n.latitude;return r.a.createElement("div",{className:"view__detail"},r.a.createElement("img",{className:"view__image",src:a.logo}),r.a.createElement("ul",null,r.a.createElement("li",{className:"view__element",key:"".concat(m.random.number(0,99),"-").concat(a.id)},a.alias),r.a.createElement("li",{className:"view__element",key:"".concat(m.random.number(0,99),"-").concat(a.id)},"created at: ",t),r.a.createElement("li",{className:"view__element",key:"".concat(m.random.number(0,99),"-").concat(a.id)},"address: ",a.address),r.a.createElement("li",{className:"view__element",key:"".concat(m.random.number(0,99),"-").concat(a.id)},"location:",c," (longitude), ",s," (latitude)")))},j=Object(f.e)((function(e){var t=e.history,a=e.id,c=Object(n.useState)(void 0),s=Object(u.a)(c,2),l=s[0],m=s[1];Object(n.useEffect)((function(){Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.retrieveDeployment(a);case 2:t=e.sent,m(t);case 4:case"end":return e.stop()}}),e)})))()}),[]);return r.a.createElement("section",{className:"deployments view"},r.a.createElement("div",{className:"view__navigate"},r.a.createElement("p",null,"deployment detail  | ")," ",r.a.createElement("button",{onClick:function(){return t.go(-1)}}," ",r.a.createElement("i",{class:"fas fa-chevron-left"})," on back")," | ",r.a.createElement("button",{onClick:function(){t.push("/deployments/register")}}," ",r.a.createElement("i",{class:"fas fa-plus"})," deployment")),l&&r.a.createElement(w,{onDeployment:l}))})),x=Object(f.e)((function(e){var t=e.history,a=Object(n.useState)("true"),c=Object(u.a)(a,2),s=c[0],l=c[1],m=Object(n.useState)("form"),d=Object(u.a)(m,2),f=d[0],v=d[1],h=Object(n.useState)(),E=Object(u.a)(h,2),g=E[0],y=E[1],b=function(){var e=Object(i.a)(o.a.mark((function e(t){var a,n,r,c,s,l,i,m,d,f;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=t.target,n=Object(u.a)(a.logo.files,1),r=n[0],c=a.name.value,s=a.address.value,e.next=4,p.getLocation(s);case 4:l=e.sent,i=l.getAddress,m=l.coordinates,d=m.lat,f=m.lng,y({logo:r,name:c,getAddress:i,lng:f,lat:d}),v("confirm");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(i.a)(o.a.mark((function e(a,n,r,c,s,l){var i,u,m,d,f;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.registerDeployment(n,c,r,s,l);case 3:if(i=e.sent,u=i.message,m=i.deployment,console.log(u),!a){e.next=12;break}return e.next=10,p.registerDeploymentImage(m.id,a);case 10:d=e.sent,console.log(d);case 12:t.push("/deployments"),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),f=e.t0.message,console.error(f);case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t,a,n,r,c,s){return e.apply(this,arguments)}}();return r.a.createElement("section",{className:"register-deployment"},r.a.createElement("div",{className:"filter view__navigate"},r.a.createElement("p",null,"deployment register | ",r.a.createElement("button",{onClick:function(){return t.go(-1)}}," ",r.a.createElement("i",{class:"fas fa-chevron-left"})," on back"))),"form"===f&&r.a.createElement("form",{className:"register-deployment__form",method:"post",onSubmit:b,encType:"multipart/form-data"},r.a.createElement("label",null,"image:"),r.a.createElement("input",{type:"file",name:"logo"}),r.a.createElement("label",null,"name:"),r.a.createElement("input",{type:"text",name:"name",placeholder:"name",required:!0}),r.a.createElement("label",null,"location address:"),r.a.createElement("input",{type:"text",name:"address",placeholder:"address"}),r.a.createElement("select",{value:s,onChange:function(e){e.preventDefault();var t=e.target.value;l(t)}},r.a.createElement("option",{value:"true"},"active"),r.a.createElement("option",{value:"false"},"inactive")),r.a.createElement("button",{className:"register__button"},r.a.createElement("i",{class:"fas fa-chevron-right"})," save")),"confirm"===f&&r.a.createElement("section",{className:"register-deployment__confirm"},r.a.createElement("p",{className:"register-deployment__text"},"confirm location:"),r.a.createElement("p",{className:"register-deployment__text"},g.getAddress),r.a.createElement("button",{className:"register-deployment__button",onClick:function(){var e=g.logo,t=g.name,a=g.getAddress,n=g.lng,r=g.lat;_(e,t,s,a,n,r)}},"yes"),r.a.createElement("button",{className:"register-deployment__button",onClick:function(){v("form")}},"return")))})),O=function(e){var t,a,n=e.onKey;return n&&(t=b()(n.valid_from).format("HH:mm DD-MM-YYYY"),a=b()(n.valid_until).format("HH:mm DD-MM-YYYY")),r.a.createElement("div",{className:"view__list"},r.a.createElement("ul",null,r.a.createElement("li",{className:"view__item",key:"".concat(m.random.number(0,99),"-").concat(n.id)},r.a.createElement("i",{className:"fas fa-key"})," ",n.alias_guest),r.a.createElement("li",{className:"view__item",key:"".concat(m.random.number(0,99),"-").concat(n.id)},n.email_guest),r.a.createElement("li",{className:"view__item",key:"".concat(m.random.number(0,99),"-").concat(n.id)},"valid from: ",t),r.a.createElement("li",{className:"view__item",key:"".concat(m.random.number(0,99),"-").concat(n.id)},"valid until: ",a),r.a.createElement("li",{className:"view__item",key:"".concat(m.random.number(0,99),"-").concat(n.id)},"status: ",r.a.createElement("span",{className:"keys__status--".concat(n.status)},n.status))))},N=Object(f.e)((function(e){var t=e.history,a=Object(n.useState)(void 0),c=Object(u.a)(a,2),s=c[0],l=c[1],m=Object(n.useState)(void 0),d=Object(u.a)(m,2),f=d[0],v=d[1],h=Object(n.useState)("keys"),y=Object(u.a)(h,2),b=y[0],_=y[1];Object(n.useEffect)((function(){Object(i.a)(o.a.mark((function e(){var t,a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.retrieveKeys();case 3:t=e.sent,a=t.sort((function(e,t){return t.created_at-e.created_at})),0===t.length||l(a),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),n=e.t0.message,console.error(n);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))()}),[]);var k=function(){var e=Object(i.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.searchKeys(t);case 3:a=e.sent,v(a),_("results"),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),"no results"===(n=e.t0.message)&&_("results"),console.error(n);case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("section",{className:"keys view"},r.a.createElement("div",{className:"view__navigate navigate__search"},r.a.createElement("div",{className:"navigate__item"},r.a.createElement("p",null,"keys:  "),r.a.createElement("button",{onClick:function(){t.push("/deployments/keys/register")}},r.a.createElement("i",{class:"fas fa-plus"})," key"),r.a.createElement("button",{onClick:function(){t.push("/deployments/keys/calendar")}},r.a.createElement("i",{class:"fas fa-chevron-left"})," calendar")),r.a.createElement("div",{className:"navigate__item"},r.a.createElement("p",null,"search keys: "),r.a.createElement(g,{onSearch:k}),"results"===b&&r.a.createElement("button",{onClick:function(){v(void 0),_("keys")}},r.a.createElement("i",{class:"fas fa-plus"})," all"))),"results"===b&&r.a.createElement("h2",null,"results:"),r.a.createElement("div",{className:"view__elements"},"keys"===b&&r.a.createElement(r.a.Fragment,null,s&&s.map((function(e){return r.a.createElement(E.b,{className:"view__element",key:e.id,to:"/deployments/keys/detail/".concat(e.id)},r.a.createElement(O,{onKey:e}))}))||r.a.createElement("p",null,r.a.createElement("i",{class:"fas fa-comment-dots"})," there are no registered keys")),"results"===b&&r.a.createElement(r.a.Fragment,null,f&&f.map((function(e){return r.a.createElement(E.b,{className:"view__element",key:e.id,to:"/deployments/keys/detail/".concat(e.id)},r.a.createElement(O,{onKey:e}))}))||r.a.createElement("p",null,r.a.createElement("i",{class:"fas fa-comment-dots"})," there are no results to search"))))})),D=Object(f.e)((function(e){var t=e.history,a=e.id,c=Object(n.useState)(void 0),s=Object(u.a)(c,2),l=s[0],m=s[1];Object(n.useEffect)((function(){Object(i.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.retrieveKey(a);case 3:t=e.sent,m(t),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),n=e.t0.message,console.error(n);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))()}),[]);return r.a.createElement("section",{className:"key view"},r.a.createElement("section",{className:"view__navigate"},r.a.createElement("p",null," detail key |  ",r.a.createElement("button",{onClick:function(){return t.go(-1)}}," ",r.a.createElement("i",{className:"fas fa-chevron-left"})," on back")," | ",l&&r.a.createElement("button",{onClick:function(e){e.preventDefault(),t.push("/deployments/detail/".concat(l.deployment))}}," ",r.a.createElement("i",{className:"fas fa-chevron-left"})," go deployment")," ",r.a.createElement("button",{onClick:function(){t.push("/deployments/keys/register")}}," ",r.a.createElement("i",{className:"fas fa-plus"})," key"))),l&&r.a.createElement("section",{className:"key__detail"}," ",r.a.createElement(O,{onKey:l})))})),S=Object(f.e)((function(e){var t=e.onDate,a=e.history,c=Object(n.useState)("register"),s=Object(u.a)(c,2),l=s[0],m=s[1],d=Object(n.useState)(void 0),f=Object(u.a)(d,2),v=f[0],h=f[1],E=Object(n.useState)(void 0),g=Object(u.a)(E,2),y=g[0],_=g[1],k=Object(n.useState)(void 0),w=Object(u.a)(k,2),j=w[0],x=w[1],O=Object(n.useState)(void 0),N=Object(u.a)(O,2),D=N[0],S=N[1],Y=Object(n.useState)(void 0),C=Object(u.a)(Y,2),M=C[0],F=C[1],K=Object(n.useState)(void 0),H=Object(u.a)(K,2),U=H[0],z=H[1];Object(n.useEffect)((function(){Object(i.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.retrieveDeployments();case 2:a=e.sent,h(a),a.length?(_(a[0].id),m("register"),b()(t).diff(b()(new Date),"days")<0&&m("error date")):m("error");case 5:case"end":return e.stop()}}),e)})))()}),[a.location]);var L=function(){var e=Object(i.a)(o.a.mark((function e(t,n,r,c,s){var l,i,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.registerKey(t,n,r,c,s);case 3:l=e.sent,i=l.message,console.log(i),a.push("/deployments/keys"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),u=e.t0.message,console.error(u);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,a,n,r,c){return e.apply(this,arguments)}}(),q=function(){return a.go(-1)};return r.a.createElement(r.a.Fragment,null,"register"===l&&r.a.createElement("section",{className:"register-key"},r.a.createElement("div",{className:"view__navigate"},r.a.createElement("p",null,"key register | ",r.a.createElement("button",{onClick:q}," ",r.a.createElement("i",{class:"fas fa-chevron-left"})," on back"))),r.a.createElement("section",null,r.a.createElement("form",{className:"register-key__form",onSubmit:function(e){e.preventDefault();var t=e.target,a=t.validFromDate.value,n=t.validFromTime.value,r=t.validUntilDate.value,c=t.validUntilTime.value,s=t.alias.value,l=t.email.value,o=new Date("".concat(a," ").concat(n)),i=new Date("".concat(r," ").concat(c));L(o,i,s,l,y)}},r.a.createElement("label",null,"valid from:"),r.a.createElement("input",{type:"date",name:"validFromDate",value:t,onChange:function(e){e.preventDefault(),x(e.target.value)},required:!0}),r.a.createElement("input",{type:"time",name:"validFromTime",onChange:function(e){e.preventDefault(),F(e.target.value)},required:!0}),r.a.createElement("label",null,"valid until:"),r.a.createElement("input",{type:"date",name:"validUntilDate",value:t||D||j,onChange:function(e){e.preventDefault(),S(e.target.value)},required:!0}),r.a.createElement("input",{type:"time",name:"validUntilTime",value:U||b()(M,"hh:mm A").add(1,"hours").format("HH:mm"),onChange:function(e){e.preventDefault(),z(e.target.value)},required:!0}),r.a.createElement("label",null,"guest:"),r.a.createElement("input",{type:"text",name:"alias",placeholder:"name",required:!0}),r.a.createElement("input",{type:"email",name:"email",placeholder:"email",required:!0}),r.a.createElement("label",null,"deployment:"),v&&r.a.createElement("select",{onChange:function(e){e.preventDefault(),e.target.value?_(e.target.value):_(v[0].id)}},v.map((function(e){return r.a.createElement("option",{value:e.id},e.alias)})))||r.a.createElement("p",null,"there are no deployments"),r.a.createElement("button",{className:"register__button"},r.a.createElement("i",{class:"fas fa-chevron-right"})," save")))),"error"===l&&r.a.createElement("section",null,r.a.createElement("p",null,"in order generate keys, first create deployments"),r.a.createElement("button",{onClick:function(){a.push("/deployments/register")}},r.a.createElement("i",{class:"fas fa-plus"})," deployments")),"error date"===l&&r.a.createElement("section",null,r.a.createElement("p",null,"you have chosen a date before the current one. try again"),r.a.createElement("button",{onClick:q},r.a.createElement("i",{class:"fas fa-chevron-right"})," return")))})),Y=Object(f.e)((function(e){var t=e.onEvent,a=e.history,c=Object(n.useState)(b()()),s=Object(u.a)(c,2),l=s[0],m=s[1],d=Object(n.useState)([]),f=Object(u.a)(d,2),v=f[0],h=f[1];Object(n.useEffect)((function(){Object(i.a)(o.a.mark((function e(){var t,a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.retrieveKeys();case 3:t=e.sent,a=t.filter((function(e){return b()(l).isSame(t.valid_from,"month")})),h(a),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),n=e.t0.message,console.error(n);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))()}),[]);var g=function(){a.push("/deployments/keys/register")},y=function(){a.push("/deployments/register")};function _(e){e.preventDefault(),m(b()(l).add(1,"months"))}function k(e){e.preventDefault(),m(b()(l).subtract(1,"months"))}function w(e){return v.map((function(t){var n=b()(t.valid_from).format("YYYY MMMM D"),c=b()(e).format("YYYY MMMM D"),s=b()(t.valid_from).format("HH:mm");if(n===c)return r.a.createElement("div",{className:"calendar__key",onClick:function(e){e.preventDefault(),e.stopPropagation(),a.push("/deployments/keys/detail/".concat(t.id))}},r.a.createElement("i",{class:"fas fa-key"})," ",t.alias_guest,r.a.createElement("br",null),r.a.createElement("i",{class:"fas fa-home"})," ",t.deployment.alias," ",r.a.createElement("br",null),"(",r.a.createElement("i",{class:"fas fa-calendar-check"})," ",s,") ")}))}return r.a.createElement("section",{className:"calendar"},r.a.createElement("div",{className:"calendar__header"},r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"calendar"),r.a.createElement("i",{class:"fas fa-caret-left",onClick:k})," ",r.a.createElement("h3",{class:"month__title"}," ",b()(l).format("MMMM")," ")," ",r.a.createElement("i",{class:"fas fa-caret-right",onClick:_}),r.a.createElement("p",{class:"month__year"},b()(l).format("YYYY")),r.a.createElement("button",{onClick:g},r.a.createElement("i",{class:"fas fa-plus"})," key"),r.a.createElement("button",{onClick:y},r.a.createElement("i",{class:"fas fa-plus"})," deployment"))),r.a.createElement("div",null,function(){for(var e=[],t=b()(l).startOf("week"),a=0;a<7;a++)e.push(r.a.createElement("div",null,t.add(1,"days").format("ddd")));return r.a.createElement("div",{class:"calendar__header"},e)}(),function(){var e=b()(l).startOf("month"),a=b()(l).endOf("month"),n=b()(a).endOf("week"),c=[],s=[],o="",i="",u=e;switch(u.day()){case 1:u.add(7,"days");break;case 2:u.add(6,"days");break;case 3:u.add(5,"days");break;case 4:u.add(4,"days");break;case 5:u.add(3,"days");break;case 6:u.add(2,"days");break;case 0:u.add(1,"days")}if("1"!==e.day())for(u=b()(u).subtract(1,"week");u<=b()(u).endOf("week").day();)for(var m=0;m<7;m++){o=u.format("D"),i=u.format("YYYY-MM-DD");var d=u.format();s.push(r.a.createElement("a",{onClick:t,"data-day":i,className:b()(l).isSame(d,"month")?b()().isSame(d,"day")?"calendar__selected":"calendar__day day":"calendar__disabled"},o,v&&r.a.createElement("div",null,w(d)))),u=u.add(1,"days")}for(;u<=n;){for(var p=0;p<7;p++){o=u.format("D"),i=u.format("YYYY-MM-DD");var f=u.format();s.push(r.a.createElement("a",{onClick:t,"data-day":i,className:b()(l).isSame(f,"month")?b()().isSame(f,"day")?"calendar__selected":"calendar__day day":"calendar__disabled"},o,v&&r.a.createElement(E.b,null,w(f)))),u=u.add(1,"days")}c.push(r.a.createElement("div",{class:"calendar__week"}," ",s," ")),s=[]}return r.a.createElement("div",null,c)}()))})),C=(a(280),function(e){var t=e.goOnLogout,a=Object(n.useState)(void 0),c=Object(u.a)(a,2),s=c[0],l=c[1];return Object(n.useEffect)((function(){Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.retrieveUser();case 2:t=e.sent,l(t);case 4:case"end":return e.stop()}}),e)})))()}),[]),r.a.createElement("header",{className:"header header__home"},r.a.createElement(E.b,{to:"/deployments"},r.a.createElement("h1",{className:"header__logo"},"the keymaker")),r.a.createElement("nav",{className:"menu"},r.a.createElement("ul",null,r.a.createElement("li",{className:"menu__button"},r.a.createElement(E.b,{to:"/deployments"},r.a.createElement("i",{className:"fas fa-home"}))),r.a.createElement("li",{className:"menu__button"},r.a.createElement(E.b,{to:"/deployments/keys"},r.a.createElement("i",{className:"fas fa-key"}))),r.a.createElement("li",{className:"menu__button"},r.a.createElement(E.b,{to:"/deployments/keys/calendar"},r.a.createElement("i",{className:"fas fa-calendar-times"}))),r.a.createElement("li",{className:"menu__image"},s&&r.a.createElement("img",{src:s.logo})),r.a.createElement("li",{className:"menu__button"},r.a.createElement("a",{href:"",onClick:t},r.a.createElement("i",{className:"fas fa-sign-out-alt"}))))))}),M=Object(f.e)((function(e){var t=e.history,a=Object(n.useState)(void 0),c=Object(u.a)(a,2),s=c[0],l=c[1],m=Object(n.useState)(void 0),d=Object(u.a)(m,2),v=d[0],h=d[1],E=Object(n.useState)("home"),g=Object(u.a)(E,2),y=(g[0],g[1]);Object(n.useEffect)((function(){Object(i.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.retrieveKeys();case 3:t=e.sent,h(t),y("home"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),a=e.t0.message,console.error(a);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))()}),[t.location]);var b=function(e){e.preventDefault(),l(e.target.dataset.day),t.push("/deployments/keys/register")};return r.a.createElement(r.a.Fragment,null,r.a.createElement(C,{className:"home-header",goOnLogout:function(){p.logUserOut(),t.push("/")}}),r.a.createElement("main",{className:"home-main"},r.a.createElement(f.a,{exact:!0,path:"/deployments",render:function(){return r.a.createElement(k,null)}}),r.a.createElement(f.a,{path:"/deployments/detail/:id",render:function(e){return r.a.createElement(j,{id:e.match.params.id})}}),r.a.createElement(f.a,{path:"/deployments/register",render:function(){return r.a.createElement(x,null)}}),r.a.createElement(f.a,{exact:!0,path:"/deployments/keys",render:function(){return r.a.createElement(N,null)}}),r.a.createElement(f.a,{path:"/deployments/keys/detail/:id",render:function(e){return r.a.createElement(D,{id:e.match.params.id})}}),r.a.createElement(f.a,{path:"/deployments/keys/register",render:function(){return r.a.createElement(S,{onDate:s})}}),r.a.createElement(f.a,{path:"/deployments/keys/calendar",render:function(){return v&&r.a.createElement(Y,{onEvent:b})}})),r.a.createElement("footer",{className:"home-footer"},r.a.createElement("p",null,r.a.createElement("i",{className:"fas fa-rocket"})," made by jose ortu\xf1o")))})),F=(a(281),Object(f.e)((function(e){var t=e.match.params.id,a=Object(n.useState)(void 0),c=Object(u.a)(a,2),s=c[0],l=c[1],m=Object(n.useState)(void 0),d=Object(u.a)(m,2),f=d[0],v=d[1],h=Object(n.useState)(void 0),E=Object(u.a)(h,2),g=E[0],y=E[1],_=Object(n.useState)(void 0),k=Object(u.a)(_,2),w=k[0],j=k[1],x=Object(n.useState)("waiting"),O=Object(u.a)(x,2),N=O[0],D=O[1];Object(n.useEffect)((function(){Object(i.a)(o.a.mark((function e(){var a,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.retrieveKey(t);case 3:return a=e.sent,v(b()(a.valid_from).format("DD-MM-YYYY HH:mm")),y(b()(a.valid_until).format("DD-MM-YYYY HH:mm")),l(a),e.next=9,p.retrieveDeployment(a.deployment);case 9:n=e.sent,j(n),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),r=e.t0.message,console.error(r);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})))()}),[]);var S=function(){var e=Object(i.a)(o.a.mark((function e(a,n){var r,c,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.useKey(t,a,n);case 3:r=e.sent,"close"===(c=r.deployment).status&&D("close"),"open"===c.status&&D("open"),console.log(c.status),e.next=17;break;case 10:e.prev=10,e.t0=e.catch(0),"jwt expired"===(l=e.t0.message)&&D("expiry"),"jwt not active"===l&&D("not activated"),l==="operation not allowed: the state of the key is ".concat(s.status)&&D("visited"),console.error(l);case 17:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"access"},w&&r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"access__header"},r.a.createElement("h1",null,"the keymaker")),r.a.createElement("main",{className:"access__main"},r.a.createElement("div",{className:"access__title"},r.a.createElement("h2",null,"Access to ",w.alias)),r.a.createElement("img",{className:"access__image",src:w.logo}),r.a.createElement("section",{className:"access__status"},"waiting"===N&&r.a.createElement("button",{className:"access__button",onClick:function(e){var t,a;e.preventDefault(),navigator.geolocation.getCurrentPosition((function(e){return t=e.coords.latitude,a=e.coords.longitude,S(a,t)}))}},r.a.createElement("i",{class:"fas fa-chevron-right"}),"ACCESS"),"open"===N&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-lock-open"}),r.a.createElement("p",null,"open the door")),"close"===N&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-lock"}),r.a.createElement("p",null,"door closed")),"visited"===N&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{class:"far fa-meh-rolling-eyes"}),r.a.createElement("p",null,"visited property")),"expiry"===N&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-sad-tear"}),r.a.createElement("p",null,"expired key")),"not activated"===N&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-clock"}),r.a.createElement("p",null,"key not activated"))),r.a.createElement("section",{className:"access__info"},r.a.createElement("h2",null,r.a.createElement("i",{class:"fas fa-door-open"})," info"),r.a.createElement("p",null,"address: ",w.address),r.a.createElement("p",null,"valid from: ",f,"H"),r.a.createElement("p",null,"valid until: ",g,"H"),r.a.createElement("p",null,"status: ",r.a.createElement("span",{className:"keys__status--".concat(s.status)},s.status))))))}))),K=Object(f.e)((function(e){var t=e.history,a=Object(n.useState)("landing"),c=Object(u.a)(a,2),s=(c[0],c[1]),l=function(){return t.push("/")},m=function(){var e=Object(i.a)(o.a.mark((function e(a,n,r,c){var s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.registerUser(a,n,r,c);case 3:t.push("/login"),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),s=e.t0.message,console.log("fail register",s);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a,n,r){return e.apply(this,arguments)}}(),d=function(){var e=Object(i.a)(o.a.mark((function e(a,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.authenticateUser(a,n);case 3:s("home"),t.push("/deployments"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),r=e.t0.message,console.log("fail login",r);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,a){return e.apply(this,arguments)}}(),E=function(e){e.preventDefault(),t.push("/register")},g=function(e){e.preventDefault(),t.push("/login")},y=function(){p.logUserOut(),t.push("/")};return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{path:"/access/:id",render:function(e){return r.a.createElement(F,null)}}),r.a.createElement("div",{className:"container"},r.a.createElement("section",{className:"landing"},r.a.createElement(f.a,{exact:!0,path:"/",render:function(){return p.isUserLogged()?t.push("/deployments"):r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:"landing__title"},"the keymaker"),r.a.createElement("section",{className:"landing__sion"},r.a.createElement("img",{className:"landing__image",src:"https://res.cloudinary.com/dgsndtxtl/image/upload/v1568838146/logo-small_vcfw3z.png"}),r.a.createElement("p",{className:"landing__text"},'"you can save zion if you get to the source. for this you will need the Keymaker." the oracle - the matrix reloaded')),r.a.createElement("ul",{className:"landing__list"},r.a.createElement("li",{className:"landing__item"},r.a.createElement("a",{href:"",onClick:E},r.a.createElement("i",{class:"fas fa-chevron-right"})," Register")),r.a.createElement("li",{className:"landing__item"},r.a.createElement("a",{href:"",onClick:g},r.a.createElement("i",{class:"fas fa-chevron-right"})," Login"))))}}),r.a.createElement(f.a,{path:"/register",render:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:"landing__title"},"the keymaker"),r.a.createElement("section",{className:"landing__sion"},r.a.createElement("img",{className:"landing__image",src:"https://res.cloudinary.com/dgsndtxtl/image/upload/v1568838146/logo-small_vcfw3z.png"}),r.a.createElement("p",{className:"landing__text"},'"you can save zion if you get to the source. for this you will need the Keymaker." the oracle - the matrix reloaded')),r.a.createElement(v,{onBack:l,onRegister:m}))}}),r.a.createElement(f.a,{path:"/login",render:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:"landing__title"},"the keymaker"),r.a.createElement("section",{className:"landing__sion"},r.a.createElement("img",{className:"landing__image",src:"https://res.cloudinary.com/dgsndtxtl/image/upload/v1568838146/logo-small_vcfw3z.png"}),r.a.createElement("p",{className:"landing__text"},'"you can save zion if you get to the source. for this you will need the Keymaker." the oracle - the matrix reloaded')),r.a.createElement(h,{onBack:l,onLogin:d}))}})),r.a.createElement(f.a,{path:"/deployments",render:function(){return p.isUserLogged()?r.a.createElement(M,{onBack:l,onLogout:y}):t.push("/")}})))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(E.a,null,r.a.createElement(K,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[135,1,2]]]);
//# sourceMappingURL=main.07038d2e.chunk.js.map